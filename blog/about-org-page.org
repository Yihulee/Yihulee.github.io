#+TITLE:       关于org-page的配置
#+AUTHOR:      
#+EMAIL:       Administrator@ACER
#+DATE:        2016-01-30 周六
#+URI:         /blog/%y/%m/%d/about-org-page
#+KEYWORDS:    技巧
#+TAGS:        技巧
#+LANGUAGE:    en
#+OPTIONS:     H:3 num:nil toc:nil \n:nil ::t |:t ^:nil -:nil f:t *:t <:t
#+DESCRIPTION: 好吧！我觉得好坑的一件事情！
* 坑在哪里？
之前我配置过一个*hexo*博客,大概花了一个多小时，一个多小时后，我就安心用markdown来写博文，发布了，好吧，本来也就那样啦，不过，一不小心看到了org-page,当时的第一印象是字体真他妈漂亮，回来再看看自己那个博客，觉得虽然效果非常炫丽，但是其实没什么用。所以就想尝试一下org-page。

我真的有些佩服自己，干啥不好，喜欢折腾这个鬼东西。我花了多久才折腾好这个博客呢？大概两天。请对比一下前面的一个小时，看看这个东西坑在哪里。

我来小小地吐槽一下我碰到的坑。

1.命令的执行的过程中没有丝毫的提示，只是报错，而且报的错我是压根就不知道错在了哪里。
一个很简单的例子，我在执行:

#+BEGIN_SRC lisp
op/new-repository
#+END_SRC

命令的时候，emacs进常会给我报如下的错误：

#+BEGIN_SRC shell
Failed to change branch to source of repository
#+END_SRC

无法转换到source分支，什么鬼？怎么会出这个错误？如果用户是小白，立马懵逼了。

对，刚开始的我也是这样的。我在自己的win7上试了几遍，每次都报错，我怀疑，作者设计的这个东西只能用在linux上面？我换了ubuntu kylin去尝试，依旧问题不断，我配着配着感到很恶心，停止了一段时间。

然而转机还是出现了，我不知道发了什么疯，居然想到了到虚拟机上的linux主机上去配置，居然一次就成功了，真够神奇的。然后又跑到自己的win7和ubuntu kylin上去配置，居然又失败了。

我突然很好奇，这玩意，究竟怎么弄的，一会儿好一会儿不好的。索性就去看了一下源代码，还好代码不是很难，还带了一点注释，不然就真的没法玩了，下面的这段大概是op/new-repository的源码：
#+BEGIN_SRC elisp
(defun op/new-repository (repo-dir)
  "Generate a new git repository in directory REPO-DIR, which can be
perfectly manipulated by org-page."
  (interactive
   (list (read-directory-name
          "Specify a directory to become the repository: " nil nil nil)))
  (op/git-init-repo repo-dir) ; 执行git init命令
  (op/generate-readme repo-dir) ; 产生 readme 文件
  (op/git-commit-changes repo-dir "initial commit") ; 提交git commit -m "initial commit" 
  (op/git-new-branch repo-dir op/repository-org-branch) ; 新建分支
  (op/generate-index repo-dir) ; 产生 index.org 文件
  (op/git-commit-changes repo-dir "add source index.org") ;执行 commit -m "add source index.org"
  (op/generate-about repo-dir) ; 产生 about.org 文件
  (op/git-commit-changes repo-dir "add source about.org") ; 执行 git commit -m "add sorce about.org"
  (mkdir (expand-file-name "blog/" repo-dir) t)) ; 新建 blog 文件夹
#+END_SRC

上面大概就是op/new-repository函数所干的事情。
我大概地看了一下op/git-int-repo函数：
#+BEGIN_SRC elisp
(defun op/git-init-repo (repo-dir)
  "This function will initialize a new empty git repository. REPO-DIR is the
directory where repository will be initialized."
  (unless (file-directory-p repo-dir)
    (mkdir repo-dir t)) ; 如果 repo-dir 所指示的文件夹不存在，建立文件夹
  (unless (string-prefix-p "Initialized empty Git repository"
                           (op/shell-command repo-dir "git init" nil)) ; 执行 git init 命令
    (error "Fatal: Failed to initialize new git repository '%s'." repo-dir)))
#+END_SRC

在上面的文件中，我发现了一个很有趣的东西，那就是作者写的elisp文件更像是一个脚本，只是通过执行相应的命令，然后比对命令输出的结果，来判断命令执行是否正确，看到这里，我知道为什么我的ubuntu kylin系统执行op/new-repository命令老是出错了，因为它的git命令是中文的：
[[http://img3.douban.com/icon/u3288655-41.jpg]
